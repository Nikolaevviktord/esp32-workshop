[//]: # (это будет бесконечно...)

# Знакомство с линейкой микроконтроллеров ESP32. Настройка Arduino IDE для работы с ESP32

<details>
  <summary> Словарь сокращений </summary>
  <blockquote>
  
  + GPIO - General Purpose Input/Output, универсальные входы/выходы
  + ШИМ (PWM) - Широтно-Импульсная Модуляция (Pulse Width Modulation)
  + ЦАП (DAC) - Цифро-Аналоговый преобразователь (Digital-to-Analog Converter)
  + АЦП (ADC) - Аналого-Цифровой преобразователь (Analog-to-Digital Converter)
  + ROM (ПЗУ) - Read-Only Memory (Постоянное запоминающее устройство)
  + SRAM (ОЗУ) - Static RAM (Оперативное запоминающее устройство)
  + PSRAM (Pseudo SRAM) - Псевдостатическая RAM
  + VDD - рабочее напряжение модуля
  + VIH, VIL, VOH, VOL - Voltage In/Out Low/High (Напряжение Входящее/Выходящее Низкое/Высокое)

</blockquote>
</details>

---

## Часть 1. Обзор семейства микроконтроллеров ESP32

Микроконтроллеры ESP32 от Espressif Systems — это мощные и универсальные "мозги" для современных электронных проектов, особенно для Интернета вещей (IoT). Давайте разберем их основные характеристики (попутно узнавая, за что отвечает та или иная характеристика).

---

<details open>
  <summary> 1. Тактовая частота </summary>
  <blockquote>

  **Тактовая частота** — это скорость выполнения базовых операций микроконтроллером. Измеряется в **герцах (Hz)**, где 1 Гц = 1 операция в секунду. Чем выше частота, тем быстрее микроконтроллер работает.

**Ключевое уточнение:** Хотя частота измеряется в операциях в секунду, **не все операции выполняются за 1 такт**. Сложные вычисления (умножение, деление) требуют большего времени.

---

**ESP32 и его частоты:**
*   **Максимум:** 240 МГц (теоретически ~240 млн операций в секунду).
*   **Настройка:** Частоту можно менять программно для баланса скорости и энергопотребления.
*   **Доступные частоты (пример из Arduino IDE):**
    *   **240MHz, 160MHz, 80MHz** (Необходимы для работы WiFi/BT)
    *   **40MHz** (Полная скорость 40MHz кварца)
    *   **20MHz** (40MHz / 2)
    *   **10MHz** (40MHz / 4)
    *   **26MHz** (Полная скорость 26MHz кварца)
    *   **13MHz** (26MHz / 2)

**Зачем менять частоту?**
1.  **Экономия заряда:** Главная причина. Чем ниже частота, тем меньше энергии потребляет плата.
2.  **Меньше нагрева:** Работа на 240 МГц может ощутимо нагревать чип.
3.  **Стабильность:** В сложных условиях (жара, плохое питание) низкие частоты надежнее.

---

**Сравнение с Arduino Uno/Nano:**
*   **Arduino:** Работает на **16 МГц**.
*   **ESP32:** Максимум **240 МГц**.
*   **Итог:** ESP32 имеет **значительное преимущество в скорости** (теоретически ~15 раз на максимальной частоте). Реальная разница может быть еще больше благодаря более эффективному процессору ESP32.

---

**Какую частоту выбрать?**
*   **240 МГц:** Максимальная производительность (сложные расчеты, быстрая связь по WiFi/BT).
*   **160/80 МГц:** Оптимальный баланс для большинства задач с WiFi/BT.
*   **40 МГц и ниже:** Экономия энергии (датчики на батарейках), простые задачи, отладка.

---
</blockquote>
</details>

<details open>
  <summary> 2. Разрядность </summary>
  <blockquote>

  1.  **Что такое разрядность?**  
    Это размер данных (бит), которые процессор обрабатывает за одну операцию. Определяется размером его регистров.

2.  **Основное отличие:**  
    *   **ESP32:** **32-битный** процессор.
    *   **Arduino (напр., Uno):** **8-битный** процессор (AVR).

3.  **Диапазон чисел за одну операцию:**  
    *   **ESP32:**  
        *   Целые числа: **0 до 4.294.967.295** (беззнак.) / **-2.147.483.648 до 2.147.483.647** (знак.).
        *   Имеет **аппаратный блок (FPU)** для быстрых операций с `float`.
    *   **Arduino:**  
        *   Целые числа: **0 до 255** (беззнак.) / **-128 до 127** (знак.).
        *   Операции с `float` выполняются **медленно** (программно).

4.  **Производительность (пример):**  
    *   **Тест простых чисел (за 30 сек):**  
        *   Arduino Uno: ~ **3600** чисел.
        *   ESP32: ~ **125 000** чисел.
    *   **Итог:** ESP32 быстрее **~ в 35 раз**.  
    *   *Примечание:* Теоретический выигрыш (из-за разрядности и частоты) выше (~60x). Разницу объясняют: более продвинутая архитектура ESP32 и наличие FPU.

5.  **Практические отличия:**  
    *   **Arduino (8-бит):**  
        *   Обрабатывает числа >8 бит **по частям** (медленнее).
        *   **Подходит для:** Простых задач (кнопки, светодиоды, реле, базовые датчики), где важны низкая стоимость и простота.
    *   **ESP32 (32-бит):**  
        *   Обрабатывает 32-битные числа **одной операцией**, эффективно работает с `float`.
        *   **Необходим для:** Сетей (Wi-Fi/BLE), цветных дисплеев, сложных вычислений (фильтры, ПИД), работы с большими данными.

**Суть:** 32-битная разрядность ESP32 позволяет ему обрабатывать большие числа и сложные задачи (особенно с `float`) намного эффективнее 8-битного Arduino, что подтверждается тестами (например, в ~35 раз в тесте простых чисел). Выбор зависит от задачи: простота и экономия – Arduino; мощность и функциональность – ESP32.

---
</blockquote>
</details>

<details open>
  <summary> 3. Ядра </summary>
  <blockquote>

  **Ядро** — физически независимый блок внутри процессора. Наличие нескольких ядер позволяет выполнять операции параллельно, повышая производительность и отзывчивость системы.  

---

**Особенности микроконтроллеров:**  
1. **ESP32:**  
   - Большинство модулей (**ESP32, ESP32-S3**) имеют **два ядра**.  
   - Исключения:  
     - *Одноядерные:* ESP32-S2, ESP32-C3, ESP32-C6, ESP32-H2.  
     - *Трёхъядерный:* ESP32-P4.  

2. **Arduino:**  
   - Все платы на базе **AVR** (Uno, Nano, Mega) и **ARM** (Due, Zero, Portenta) используют **одно ядро**.  
   - Многозадачность реализуется менее эффективно (псевдопараллельно).  

---

**Преимущества многоядерных чипов (ESP32):**  
- **Реальная параллельность:** Выполнение задач на разных ядрах без взаимных блокировок (например: обработка сети на ядре 0 + расчёты на ядре 1).  
- **Повышенная отзывчивость:** Критические задачи (сеть, прерывания) не прерываются фоновыми процессами.  
- **Производительность:** Распределение ресурсоёмких операций между ядрами.  

---

**Сложности многоядерного программирования:**  
- **Синхронизация данных:** Риск ошибок при обращении к общим ресурсам (память, периферия). Требуются механизмы защиты (например, атомарные операции).  
- **Распределение задач:** Неоптимальное закрепление задач за ядрами снижает эффективность.  
- **Отладка:** Сложнее выявлять ошибки в параллельных процессах.  

---

**Практические рекомендации для ESP32:**  
- **Ядро 0:** Системные задачи (сеть, прерывания, критичные операции).  
- **Ядро 1:** Пользовательские вычисления, логика приложения.  
- **Важно:** Всегда синхронизируйте доступ к общим данным между ядрами.  

> **Итог:** Многоядерность (ESP32) обеспечивает истинный параллелизм для сложных задач, в то время как одноядерные системы (Arduino) ограничены псевдопараллельными решениями с риском блокировок.

---
</blockquote>
</details>

<details open>
  <summary> 4. GPIO </summary>
  <blockquote>

  <details>
    <summary> ESP32 Devkit & Arduino Nano pinouts </summary>
    
  <img src="https://github.com/user-attachments/assets/dee03327-fc8b-4b6f-97d6-db1012a353bb" width="500" height="400">
  <img src="https://github.com/user-attachments/assets/23983959-d3ca-4655-8193-5d273f63dcf2" width="800" height="400">

  </details>

  GPIO - пины (выходы микроконтроллера), которые могут быть как-либо использованы пользователем (для чтения цифровых или аналоговых значений, для подачи напряжения на порт, для реализации протоколов связи и прочего).

  **На наших ESP32 таких пинов 32**. Многие из них могут работать во многих режимах, но об этом позже. На схеме "pinout" GPIO обозначены. Также к таким пинам можно *"с натяжкой"* отнести пины TX и RX.

  **На Arduino таких пинов 20-22** (зависит от модели). Из них многие работают только в одном-двух режимах (соответственно, функционал ограничен). На схеме "pinout" такие пины обозначены номерами (стоящими поодаль от платы).
  
  <blockquote>
  <details>
  <summary> Таблица с назначением всех пинов на ESP32 </summary>
  
  | Пин на плате | GPIO | Тип     | Функции                          | Особые примечания                  |
|--------------|------|---------|----------------------------------|-----------------------------------|
| 3V3          | —    | Power   | Выход 3.3V                      | Макс. ток 600 μA                 |
| VIN          | —    | Power   | Внешнее питание (5-10V)          | Через стабилизатор AM51117-3.3V  |
| GND          | —    | Ground  | Общий провод                    | Несколько въездов на плате       |
| EN           | —    | Control | Сброс/включение                 | Подтянут к VCC через 10 кОм; LOW = сброс |
| IO0          | 0    | GPIO    | ADC2_CH1, Touch1, Boot mode     | Должен быть HIGH при загрузке!   |
| TX0          | 1    | UART    | UARTD_TX (Debug)                | Отладка при загрузке; избегать   |
| IO2          | 2    | GPIO    | Встроенный LED, ADC2_CH2, Touch2 | Подтянут к GND; LOW при загрузке |
| RO0          | 3    | UART    | UARTD_RX (Debug)                | HIGH при загрузке; избегать      |
| IO4          | 4    | GPIO    | ADC2_CH0, RTC_GPIO10, Touch0    | Безопасен при загрузке           |
| IO5          | 5    | GPIO    | VSP1_C50, ADC2_CH11             | Выездят ШИМ при загрузке         |
| IO12         | 12   | GPIO    | ADC2_CH5, RTC_GPIO15, Touch5    | Должен быть LOW при загрузке!    |
| IO13         | 13   | GPIO    | ADC2_CH4, RTC_GPIO14, Touch4    | Безопасен при загрузке           |
| IO14         | 14   | GPIO    | ADC2_CH6, RTC_GPIO16, Touch6    | Выездят ШИМ при загрузке         |
| IO15         | 15   | GPIO    | ADC2_CH3, RTC_GPIO13, Touch3    | Должен быть HIGH при загрузке!   |
| IO16         | 16   | GPIO    | UART2_RX, RTC_GPIO8             | Безопасен при загрузке           |
| IO17         | 17   | GPIO    | UART2_TX, RTC_GPIO7             | Безопасен при загрузке           |
| IO18         | 18   | GPIO    | VSP1_OLS                        | Безопасен при загрузке           |
| IO19         | 19   | GPIO    | VSP1_MISO                       | Безопасен при загрузке           |
| IO21         | 21   | GPIO    | Default SDA (I2C)               | Безопасен при загрузке           |
| IO22         | 22   | GPIO    | Default SCL (I2C)               | Безопасен при загрузке           |
| IO23         | 23   | GPIO    | VSP1_MOSI                       | Безопасен при загрузке           |
| IO25         | 25   | GPIO    | DAC1_ADC2_CH8, RTC_GPIO6        | Не использовать ADC2 с Wi-Fi     |
| IO26         | 26   | GPIO    | DAC2_ADC2_CH8, RTC_GPIO7        | Не использовать ADC2 с Wi-Fi     |
| IO27         | 27   | GPIO    | ADC2_CH7, RTC_GPIO17, Touch7    | Не использовать ADC2 с Wi-Fi     |
| IO32         | 32   | GPIO    | ADC1_CH4, RTC_GPIO9, Touch9     | Безопасен при загрузке           |
| IO33         | 33   | GPIO    | ADC1_CH5, RTC_GPIO8, Touch8     | Безопасен при загрузке           |
| IO34         | 34   | Analog in | ADC1_CH6, RTC_GPIO4           | Только вход!                    |
| IO35         | 35   | Analog in | ADC1_CH7, RTC_GPIO5           | Только вход!                    |
| SVP (VP)     | 36   | Analog in | ADC1_CH3, RTC_GPIO0           | Только вход! Не поддерживает подтяжку |
| SYN (YN)     | 39   | Analog in | ADC1_CH3, RTC_GPIO3           | Только вход! Не поддерживает подтяжку |

</details>
</blockquote>

---
  
</blockquote>
</details>

<details open>
  <summary> 5. ШИМ (PWM) </summary>
  <blockquote>
  <details>
    <summary> ESP32 Devkit & Arduino Nano pinouts </summary>
    
  <img src="https://github.com/user-attachments/assets/dee03327-fc8b-4b6f-97d6-db1012a353bb" width="500" height="400">
  <img src="https://github.com/user-attachments/assets/23983959-d3ca-4655-8193-5d273f63dcf2" width="800" height="400">

  </details>

  ШИМ - механизм, позвооляющий эмулировать аналоговый сигнал путём быстрого включения/выключения сигнала. Таким образом, к примеру, можно управлять светодиодом или скоростью мотора.

  На наших **ESP32** портов, позволяющих эмулировать ШИМ **14** (12-14, 16-19, 23, 25-27, 32-33). При этом **разрядность** (точность) этих портов **до 16 бит** (то есть можно задавать **значения от 0 до 65536**).

  **На Arduino таких портов 6** (3, 5-6, 9-11). Но при необходимости можно задействовать ещё два (не будем углубляться). **Разрядность этих портов - 8 бит** (то есть принимают **значения от 0 до 255**).

---
</blockquote>
</details>

<details open>
  <summary> 6. ЦАП (DAC) </summary>
  <blockquote>
  <details>
    <summary> ESP32 Devkit pinout </summary>
    
  <img src="https://github.com/user-attachments/assets/dee03327-fc8b-4b6f-97d6-db1012a353bb" width="500" height="400">

  </details>

  ЦАП - механизм, позволяющий чипу создавать аналоговый сигнал, а не эмулировать его посредством ШИМ. Является новшеством ESP32 и его ключевым преимуществом.

  **На ESP32 есть два пина с ЦАП (25-26)**. На них можно подать напряжение от 0В до 3.3В, а именно **256 различных вариантов** выходного напряжения (разрядность ЦАП - 8 бит, от 0 до 255). *На новых моделях ESP32, как правило 1 выход ЦАП*.

  **На Arduino ЦАП не устанавливается**.

---
</blockquote>
</details>

<details open>
  <summary> 7. АЦП (ADC) </summary>
  <blockquote>
  <details>
    <summary> ESP32 Devkit & Arduino Nano pinouts </summary>
    
  <img src="https://github.com/user-attachments/assets/dee03327-fc8b-4b6f-97d6-db1012a353bb" width="500" height="400">
  <img src="https://github.com/user-attachments/assets/23983959-d3ca-4655-8193-5d273f63dcf2" width="800" height="400">

  </details>

  АЦП - механизм, позволяющий считывать аналоговый сигнал и конвертировать его в цифровое значение. К примеру, так можно обрабатывать потенциометры и датчики линии.

  **На наших ESP32 6 портов ADC1** (32-36, 39) и **10 портов ADC2** (0, 2, 4, 12-15, 25-27). Они имеют разрядность от 9 до 12 бит (настраивается программно). ADC1 и ADC2 имеют некоторые важные различия, о которых мы пошоворим позже.
  
  <blockquote>
  <details>
  <summary> Таблица пинов АЦП </summary>
  
  | GPIO | ADC  | Особенности                                |
|------|------|--------------------------------------------|
| 32   | ADC1 | Ввод/вывод (безопасен при загрузке)         |
| 33   | ADC1 | Ввод/вывод (безопасен при загрузке)         |
| 34   | ADC1 | Только вход                                |
| 35   | ADC1 | Только вход                                |
| 36   | ADC1 | Только вход (SVP)                          |
| 39   | ADC1 | Только вход (SVN)                          |
| 0    | ADC2 | Не работает с Wi-Fi; пин загрузки          |
| 2    | ADC2 | Не работает с Wi-Fi; встроенный LED        |
| 4    | ADC2 | Не работает с Wi-Fi                        |
| 12   | ADC2 | Не работает с Wi-Fi; должен быть LOW при загрузке |
| 13   | ADC2 | Не работает с Wi-Fi                        |
| 14   | ADC2 | Не работает с Wi-Fi; ШИМ при загрузке       |
| 15   | ADC2 | Не работает с Wi-Fi; должен быть HIGH при загрузке |
| 25   | ADC2 | Не работает с Wi-Fi                        |
| 26   | ADC2 | Не работает с Wi-Fi                        |
| 27   | ADC2 | Не работает с Wi-Fi                        |
  
  </details>
  </blockquote>

---
  
</blockquote>
</details>

<details open>
  <summary> 8. Связь </summary>
  <blockquote>
  <details>
    <summary> ESP32 Devkit & Arduino Nano pinouts </summary>
    
  <img src="https://github.com/user-attachments/assets/dee03327-fc8b-4b6f-97d6-db1012a353bb" width="500" height="400">
  <img src="https://github.com/user-attachments/assets/23983959-d3ca-4655-8193-5d273f63dcf2" width="800" height="400">

  </details>
  
  Краткое объяснение принципов работы основных протоколов связи размещено в отдельном [файле](https://github.com/Nikolaevviktord/esp32-workshop/blob/master/task-0-1/communication.md). Ниже приведены таблицы с характеристиками плат относительно поддержки протоколов связи.
  
  ---

Количество аппаратных выходов протокола
    
| Протокол | Arduino UNO/NANO       | ESP32                             |
| :------- | :--------------------- | :-------------------------------- |
| UART     | 1 (фикс. пины 0,1)     | 3 (пины назначаемые)              |
| SPI      | 1 (фикс. пины 11,12,13)| 2-4 (HSPI/VSPI, пины назначаемые) |
| I²C      | 1 (фикс. A4/SDA, A5/SCL)| 2 (пины назначаемые)             |

---

Поддержка протокола

| Протокол | Arduino UNO/NANO       | ESP32                             |
| :------- | :--------------------- | :-------------------------------- |
| Wi-Fi    |  Нет                 |  802.11 b/g/n (до ~150 Мбит/с) |
| Bluetooth|  Нет                 |  Classic + BLE (EDR/LE)         |

---

Максимальная скорость

| Протокол | Arduino UNO/NANO       | ESP32                             |
| :------- | :--------------------- | :-------------------------------- |
| UART     | 115200 - 2 Мбит/с¹    | 5 Мбит/с                          |
| SPI      | 8-16 МГц              | 80 МГц                            |
| I²C      | 100-400 кбит/с        | 100-1000 кбит/с (1 Мбит/с)       |

---

Энергопотребление

| Протокол | Arduino UNO/NANO       | ESP32                             |
| :------- | :--------------------- | :-------------------------------- |
| Wi-Fi    | -                     | Высокое (особенно AP/TX)          |
| BLE      | -                     | Очень низкое (в режиме сна/короткие сеансы) |

---

Программная эмуляция

| Протокол | Arduino UNO/NANO       | ESP32                             |
| :------- | :--------------------- | :-------------------------------- |
| UART/SPI/I²C |  Ограничена (I²C) |  Легко (на любых GPIO)        |

---

Ключевое применение

| Протокол | Arduino UNO/NANO       | ESP32                             |
| :------- | :--------------------- | :-------------------------------- |
| UART     | Отладка, модули       | Отладка, модули, связь МК         |
| SPI      | SD-карты, дисплеи     | SD-карты, дисплеи, камеры, Wi-Fi/Eth модули |
| I²C      | Датчики, RTC          | Датчики, RTC                      |
| Wi-Fi    | -                     | Интернет, сеть, OTA, MQTT         |
| Bluetooth| -                     | Связь с телефоном/ПК (Classic/BLE)|

---

</blockquote>
</details>

<details open>
  <summary> 9. Напряжение питания </summary>
  <blockquote>

**Напряжение питания** - это **"электрическая сила"**, которая толкает ток по проводам и заставляет электронное устройство работать. Как нужное давление воды для работы крана: слишком мало – не течет; слишком много – может прорвать.

**Сравнение напряжения ПИТАНИЯ Arduino Uno/Nano и ESP32-DevKit:**

| Характеристика                  | Arduino Uno / Nano                                | ESP32-DevKit (напр., ESP32-WROOM)          | Важно!                                                                 |
| :------------------------------ | :------------------------------------------------ | :----------------------------------------- | :--------------------------------------------------------------------- |
| **Рабочее напряжение микроконтроллера** | **5 В** (основная "внутренняя" работа)            | **3.3 В** (основная "внутренняя" работа)   | **Главное отличие!** "Сердце" плат работает на разном "давлении".     |
| **Рекомендуемое входное напряжение (питание платы)** | **Через USB:** **5 В** <br> **Через гнездо VIN/DC:** **7-12 В** | **Через USB:** **5 В** <br> **Через контакт `5V`:** **~5 В** <br> **Через контакт `3.3V` (Осторожно!):** **ТОЛЬКО 3.3 В** | Обе платы имеют **встроенные стабилизаторы напряжения**, которые преобразуют более высокое входное напряжение до нужного рабочего (5В для Uno/Nano, 3.3В для ESP32). |
| **Выходное напряжение для периферии** | **Пин `5V`:** **~5 В** (стабильно) <br> **Пин `3.3V`:** **~3.3 В** (стабильно) | **Пин `5V`:** **~5 В** (стабильно, *если вход >=5В*) <br> **Пин `3.3V`:** **~3.3 В** (стабильно) | Эти пины можно использовать для питания датчиков и модулей, **но ток ограничен** (особенно на `3.3V` у ESP32). |

**Меры предосторожности при питании плат:**

1.  **Всегда проверяйте документацию!** Точные требования к напряжению для *вашей конкретной* модели платы или модуля могут отличаться. Ищите "Operating Voltage", "Input Voltage" или "VCC".
2.  **Никогда не подавайте напряжение выше рекомендованного на входные контакты питания (VIN, `5V`, `3.3V`):**
    *   **Uno/Nano VIN:** Не превышайте ~12В (обычно указано на стабилизаторе платы).
    *   **ESP32 `5V`:** Не подавайте больше ~6В. Идеально – 5В.
    *   **ESP32 `3.3V`:** **НИКОГДА не подавайте сюда напряжение выше 3.6В!** Это **прямой вход** на чип ESP32. Подача 5В убьет плату мгновенно. Этот пин **ТОЛЬКО** для выхода 3.3В или *очень осторожного* входа строго 3.3В.
3.  **Используйте правильные источники:**
    *   **USB:** Самый безопасный вариант (5В).
    *   **Внешний блок питания:** Для Uno/Nano через VIN (7-12В), для ESP32 через `5V` (~5В). Убедитесь, что блок питания выдает нужное напряжение и достаточный ток (обычно 1А+ для надежности).
    *   **Батареи:** Литиевые (3.7В) подходят *только* для ESP32 через `5V` (т.к. 3.7В > 3.3В, но стабилизатор на `5V` входе ESP32 *понизит* его до 3.3В). Для Uno/Nano от батарей – используйте повышающий преобразователь до 7-12В или батарейный отсек на 6-9В (AA/AAA).
4.  **Осторожно с выходами `5V`/`3.3V`:**
    *   Не подключайте устройства, потребляющие слишком большой ток (например, моторы без драйвера, мощные светодиодные ленты). Это может перегрузить стабилизатор платы и вызвать его перегрев или отключение.
    *   Узнайте максимальный ток, который могут выдать эти пины (обычно ~500-800мА на `5V` для Uno, ~500мА на `5V` и гораздо меньше ~200мА на `3.3V` для ESP32).
5.  **ESP32 и 5В модули (питание VCC):** Если ваш датчик или модуль **требует** 5В для питания (VCC), **нельзя** подключать его напрямую к пину `3.3V` ESP32 – ему не хватит напряжения. Подключайте такие модули к пину `5V` ESP32 *только если* сама ESP32 питается от 5В (через USB или `5V`). **И помните:** Даже если модуль *питается* от `5V` ESP32, его *сигнальные* пины (TX/RX, SDA/SCL и т.д.) могут быть 5В – это уже вопрос логических уровней.

**Проще говоря:**

*   **Arduino Uno/Nano:** Любит, когда ей дают **7-12В** на VIN или **5В** на USB. Внутри работает на **5В**.
*   **ESP32:** Любит, когда ей дают **5В** на USB или контакт `5V`. **Никогда не давайте ей больше 3.3В на контакт `3.3V`!** Внутри работает на **3.3В**.

**Самая частая опасность:** Подать 5В на контакт `3.3V` ESP32. **Это гарантированно уничтожит плату.** Всегда дважды проверяйте, куда подключаете провода питания!

---
  </blockquote>
</details>

<details open>
  <summary> 10. Память </summary>
  <blockquote>
  
  Микроконтроллеры, такие как Arduino Uno/Nano (на базе ATmega328P) и ESP32, используют несколько типов памяти, каждый из которых выполняет свою критически важную роль:

<blockquote>
<details>
<summary>1.  **Flash (ПЗУ - Программируемое Постоянное Запоминающее Устройство):**</summary>
    *   **Назначение:** Энергонезависимая память для хранения скомпилированной программы (прошивки), констант (`const`) и загрузчика (Bootloader). Данные сохраняются при отключении питания.
    *   **Arduino Uno/Nano:** 32 КБ. Хватает для небольших программ.
    *   **ESP32:** Обычно 4 МБ (4194304 байт) на популярных модулях (например, ESP32-WROOM-32). Позволяет хранить сложные программы, библиотеки и даже файлы (через SPIFFS/LittleFS). **Объем ESP32 больше в ~128 раз.**
</details>

<details>
<summary>2.  **SRAM (Статическая Оперативная Память):**</summary>
    *   **Назначение:** Энергозависимая память (требует питания) для хранения переменных программы (глобальных, локальных, динамических), стека вызовов функций и кучи (heap) во время выполнения. Обеспечивает быструю работу программы.
    *   **Arduino Uno/Nano:** 2 КБ (2048 байт). Очень ограниченный объем, требует осторожного управления памятью.
    *   **ESP32:** 520 КБ (532480 байт) встроенной SRAM. Позволяет работать с большими массивами данных, буферами связи и сложными структурами. **Объем ESP32 больше в ~260 раз.**
</details>

<details>
<summary>3.  **EEPROM (Электрически Стираемое Программируемое ПЗУ):**</summary>
    *   **Назначение:** Небольшая энергонезависимая память для хранения данных, которые должны сохраняться между перезагрузками (настройки, калибровочные константы, счетчики). Количество циклов записи ограничено.
    *   **Arduino Uno/Nano:** 1 КБ (1024 байта) физической EEPROM.
    *   **ESP32:** Около 4 КБ, но **эмулируется** в секторе Flash-памяти с помощью библиотеки. Сохраняет свойства энергонезависимости, но циклы записи ограничены как у Flash (~100 000), а не как у "настоящей" EEPROM. Объемы сопоставимы, но реализация отличается.
</details>

<details>
<summary>4.  **PSRAM (Псевдостатическая ОЗУ) - Только ESP32 (опционально):**</summary>
    *   **Назначение:** Дополнительная энергозависимая оперативная память (обычно 4 МБ или 8 МБ), распаянная на некоторых модулях ESP32 (например, ESP32-WROVER). Предназначена для работы с *очень* большими буферами данных (аудио, изображения, видео, сложные веб-страницы).
    *   **Arduino Uno/Nano:** Отсутствует.
    *   **ESP32:** До 8 МБ (например, ESP32-WROVER-B). Медленнее и энергозатратнее встроенной SRAM, но предоставляет огромное преимущество для ресурсоемких задач. **Уникальная возможность ESP32.**
</details>

<details>
<summary>5.  **RTC SRAM (Память реального времени) - Только ESP32:**</summary>
    *   **Назначение:** Небольшой участок (8 КБ) энергозависимой SRAM, подключенный к схеме часов реального времени (RTC). Главная особенность — может сохранять данные в **режимах глубокого сна (Deep Sleep)**, если подано резервное питание (например, от батарейки на вывод `VBAT`). Используется для сохранения состояния системы перед сном.
    *   **Arduino Uno/Nano:** Отсутствует.
    *   **ESP32:** 8 КБ. **Уникальная возможность ESP32** для создания энергоэффективных приложений с глубоким сном.
</details>
</blockquote>

---

**Ключевые выводы по памяти:**

*   **ESP32 обладает на порядки большими объемами основной памяти:** Его Flash (4 МБ vs 32 КБ) больше примерно в **128 раз**, а встроенная SRAM (520 КБ vs 2 КБ) — примерно в **260 раз**, чем у Arduino Uno/Nano. Это фундаментальное преимущество для сложных проектов.
*   **EEPROM:** Объемы схожи (~1 КБ vs ~4 КБ), но на ESP32 она эмулируется во Flash, что накладывает ограничения на частоту записи.
*   **Дополнительные возможности ESP32:** Наличие опциональной **PSRAM** (до 8 МБ) решает задачи с экстремальными требованиями к ОЗУ. **RTC SRAM** (8 КБ) критически важен для продвинутых энергосберегающих режимов. Эти типы памяти отсутствуют на классических Arduino Uno/Nano.

---
  </blockquote>
</details>

<details open>
  <summary> 11. Логистические уровни </summary>
  <blockquote>
   
  | Параметр                         | ESP32 (3.3В система)         | Arduino UNO/NANO (5В система) | Критически важные отличия               |
  |----------------------------------|------------------------------|-------------------------------|-----------------------------------------|
  | **Рабочее напряжение (VDD)**     | 3.0В - 3.6В (оптимум 3.3В)   | 4.5В - 5.5В (оптимум 5.0В)    | Разные номиналы напряжения питания      |
  | **Входной высокий уровень (VIH)** | > 0.75 × VDD ≈ **>2.4В**     | > 0.6 × VDD ≈ **>3.0В**       | ESP32 распознает 3.3В как HIGH          |
  | **Входной низкий уровень (VIL)** | < 0.25 × VDD ≈ **<0.8В**     | < 0.3 × VDD ≈ **<1.5В**       | Одинаково распознают 0В как LOW         |
  | **Выходной высокий уровень (VOH)** | ≈ 3.2В (при нагрузке)        | ≈ 4.5-5.0В (при нагрузке)     | **Опасно:** 5В с Arduino > 3.6В для ESP32! |
  | **Выходной низкий уровень (VOL)** | ≈ 0.1В (при нагрузке)        | ≈ 0.1В (при нагрузке)         | Безопасное соединение при LOW           |
  | **Макс. входное напряжение**     | **3.6В** (абсолютный максимум)| 5.5В                          | Превышение вызывает повреждение ESP32!  |
  
  Ключевые предупреждения:
  1.  **Прямое соединение 5В выхода Arduino с GPIO ESP32** = **Повреждение чипа!**  
      *Решение:* Используйте делитель напряжения или преобразователь уровней (level shifter)
  2.  **Подача >3.6В на любой GPIO ESP32** = **Необратимое повреждение!**  
      *Исключение:* Некоторые модели имеют 5В-толерантные пины (обычно помечены в datasheet)
  3.  **Соединение ESP32 → Arduino:** Безопасно (3.3В > 3.0В для VIH Arduino)

---
</blockquote>
</details>

<details open>
  <summary> 12. Цена </summary>
  <blockquote>

  В таблице ниже представлена цена на различные виды Arduino и ESP32 от разных продавцов.

  | Продавец    | Arduino Uno | Arduino Nano | ESP32 Module | ESP32 Devkit |
  |-------------|-------------|--------------|--------------|--------------|
  | Оригинал    | 4800        | не нашёл     | 150          | 239          |
  | Амперка     | 2020        | 1100         | не продают   | 1190         |
  | Алиэкспресс | 193         | 122          | 150          | 239          |

---

</blockquote>
</details>

<details open>
  <summary> Итоговое сравнение ESP32 и Arduino UNO/NANO </summary>
  <blockquote>
  
  | Характеристика             | ESP32 (Типичный модуль)      | Arduino UNO/NANO             | Ключевые отличия ESP32                     |
  |----------------------------|------------------------------|------------------------------|--------------------------------------------|
  | **Архитектура ядра**       | 32-бит                       | 8-бит                        | Качественно выше производительность        |
  | **Тактовая частота**       | 240 МГц                      | 16 МГц                       | ×15 скорость                               |
  | **Количество ядер**        | 2 (большинство моделей, от 1 до 3)| 1                            | Параллельная обработка задач              |
  | **GPIO (кол-во/тип)**      | ~34 мультифункциональных     | 20-22 (фиксированные функции)   | Больше пинов, гибкая конфигурация          |
  | **ШИМ (каналы/разрядность)** | 14 / до 16 бит             | 6 / 8 бит                | Больше каналов, выше точность              |
  | **ЦАП**                    | 0-2 канала × 8 бит           | Отсутствует                  | Аппаратный аналоговый вывод                |
  | **АЦП (кан/бит/диапазон)** | 6+10 (ADC1+ADC2) / 12 бит / 0-3.3В | 6-8 / 10 бит / 0-5В    | Больше каналов, выше разрешение            |
  | **Wi-Fi**                  | Встроенный                   | Требует внешний модуль       | Готовая сетевая функциональность           |
  | **Bluetooth**              | Classic + BLE (встроено)     | Требует внешний модуль       | Беспроводная периферия "из коробки"        |
  | **Оперативная память (SRAM)** | ~520 КБ                    | 2 КБ                        | > ×260 объём                              |
  | **Память программ (Flash)** | 4-16 МБ+                    | 32 КБ                       | > ×128 объём                              |
  | **Доп. память (PSRAM)**    | До 8 МБ (опционально)        | Отсутствует                  | Буфер для ресурсоёмких задач               |
  | **Напряжение питания**     | 3.3В (чип)                   | 5В (чип)                     | Совместимость с современной периферией 3.3В|
  | **Логические уровни**      | 3.3В                         | 5В                           | **Требует преобразователей при соединении!** |
</blockquote>
</details>

[//]: # (чтобы было 548 строк)
